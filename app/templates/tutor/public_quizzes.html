<!DOCTYPE html>
{% extends "base.html" %}
{% load static %}
{% block title %}Public Quizzes{% endblock %}
{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/public_quizzes.css' %}">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://unpkg.com/htmx.org@1.9.2"></script>
{% endblock %}
{% block content %}
<h2 class="public-quizzes">Public Quizzes</h2>
{% if quizzes %}
    <ul class="list-group">
        {% for quiz in quizzes %}
            <li class="list-group-item d-flex align-items-center" id="quiz-{{ quiz.id }}">
                <span>
                    <strong>{{ quiz.name }}</strong> ({{ quiz.subject }})
                    <span class="badge {% if quiz.is_public %}bg-success{% else %}bg-secondary{% endif %}">
                        {% if quiz.is_public %}Public{% endif %}
                    </span>
                </span>
                <div class="quiz-buttons">
                    <button data-quiz-id="{{ quiz.id }}" class="btn btn-info open-preview-modal">Preview Quiz</button>
                  <a href="{% url 'save_public_quiz' quiz.id %}" class="save-quiz btn">Save copy to Library</a>
                </div>
            </li>
        {% endfor %}
    </ul>
{% else %}
    <p class="alert alert-info">There are no public quizzes.</p>
{% endif %}
<div class="modal fade" id="previewModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        
      </div>
    </div>
</div>
<script>
    $(document).on('click', '.open-preview-modal', function(e) {
        e.preventDefault();
        var quizId = $(this).data('quiz-id');
    
        $.ajax({
            url: '/preview-modal/' + quizId,
            success: function(data) {
                $('#previewModal .modal-content').html(data);
    
                // Bootstrap 5 Modal API
                var myModal = new bootstrap.Modal(document.getElementById('previewModal'));
                myModal.show();
            }
        });
    });
</script>
{% endblock %}

