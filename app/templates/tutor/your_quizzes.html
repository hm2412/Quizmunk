<!DOCTYPE html>
{% extends "base.html" %}
{% load static %}
{% block title %}Your Quizzes{% endblock %}
{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/your_quizzes.css' %}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://unpkg.com/htmx.org@1.9.2"></script>
{% endblock %}
{% block content %}
<h2 class="your-quizzes">Your Quizzes</h2>

{% if drafts %}
    <ul class="list-group">
        {% for quiz in drafts %}
            <li class="list-group-item d-flex align-items-center" id="quiz-{{ quiz.id }}">
                <span>
                    <strong>{{ quiz.name }}</strong> ({{ quiz.subject }})
                    <span class="badge {% if quiz.is_public %}bg-success{% else %}bg-secondary{% endif %}">
                        {% if quiz.is_public %}Public{% else %}Private{% endif %}
                    </span>
                </span>
                <div class="quiz-buttons"> 
                  <a href="{% url 'edit_quiz'  quiz_id=quiz.id %}" class="btn">Edit Quiz</a>
                  <button class="delete-quiz btn"
                          onclick="deleteQuiz('{{ quiz.id }}')"
                          data-quiz-id="{{ quiz.id }}">
                      Delete
                  </button>
                  <a href="{% url 'setup_quiz' quiz.id %}" class="start-quiz btn"><b>Start!</b></a>
                </div>
            </li>
        {% endfor %}
    </ul>
{% else %}
    <p class="alert alert-info">You have no draft quizzes.</p>
{% endif %}

<script>
function deleteQuiz(quizId) {
  if (!confirm("Are you sure you want to delete this quiz?")) {
    return;
  }

  $.ajax({
    url: "/delete-quiz/" + quizId + "/",
    type: "POST",
    data: { csrfmiddlewaretoken: "{{ csrf_token }}" },
    success: function () {
      $("#quiz-" + quizId).remove(); 
      showToast("Quiz deleted successfully!", "success");
    },
    error: function () {
      showToast("Error deleting quiz!", "error");
    }
  });
}
</script>
{% endblock %}

